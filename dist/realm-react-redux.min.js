!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("realm"),require("react")):"function"==typeof define&&define.amd?define(["exports","realm","react"],e):e(t.ReactRedux=t.ReactRedux||{},t.Realm,t.React)}(this,function(t,e,n){"use strict";function r(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function o(t){return!!t&&"object"==typeof t}function i(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t);try{throw Error(t)}catch(t){}}function s(t,n,r){if("object"!=typeof n)throw Error("Expected options to be an object");var o=n.realm,u=n.allowUnsafeWrites,p=void 0!==u&&u,c=n.watchUnsafeWrites,a=void 0!==c&&c,f=F(n,["realm","allowUnsafeWrites","watchUnsafeWrites"]);if(p=p||a,o&&!(o instanceof e))throw Error("Expected realmOptions.realm to be a Realm db");if(o=o||new e(f),void 0!==r){if("function"!=typeof r)throw Error("Expected the enhancer to be a function.");return r(s)(t,o)}if("function"!=typeof t)throw Error("Expected the writer to be a function.");var d=!1,l=[],h=l,y=function(){h===l&&(h=l.slice())},b=function(e){if(!M(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d){if(e.type===k.UNSAFE_WRITE)return e;throw Error("writers may not dispatch actions.")}if(e.type!==k.UNSAFE_WRITE)try{d=!0,o.write(function(){t(o,e)}),o.write(function(){})}finally{d=!1}return(l=h).forEach(function(t){return t()}),e};return o.addListener("change",function(){p||d||i("Realm updated outside of realmStore.dispatch()"),a&&!d&&b({type:k.UNSAFE_WRITE})}),{subscribe:function(t){if("function"!=typeof t)throw Error("Expected listener to be a function.");var e=!0;return y(),h.push(t),function(){if(e){e=!1,y();var n=h.indexOf(t);h.splice(n,1)}}},getRealm:function(){return o},dispatch:b,options:{allowUnsafeWrites:p,watchUnsafeWrites:a}}}function u(t){t.forEach(function(t){var e=new L('writer "'+t.name+'" operated on realm during initialization.');t(e,{type:k.INIT}),t(e=new L('writer "'+t.name+"\" operated on realm when probed with a random type.Don't try to handle "+k.INIT+' or other actions in "realm-redux/*" namespace. They are considered private.'),{type:k.PROBE_UNKNOWN_ACTION+"_"+Math.random().toString(36)})})}function p(t,e){return function(){return e(t.apply(void 0,arguments))}}function c(t,e){if("function"==typeof t)return p(t,e);if("object"!=typeof t||null===t)throw Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(t),r={},o=0;n.length>o;o++){var s=n[o],u=t[s];"function"==typeof u?r[s]=p(u,e):i("bindActionCreators expected a function actionCreator for key '"+s+"', instead received type '"+typeof u+"'.")}return r}function a(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}function f(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!==t&&e!==e}function d(t,e){if(f(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(var o=0;n.length>o;o++)if(!H.call(e,n[o])||!f(t[n[o]],e[n[o]]))return!1;return!0}function l(){var t=[],e=[];return{clear:function(){e=J,t=J},notify:function(){for(var n=t=e,r=0;n.length>r;r++)n[r]()},subscribe:function(n){var r=!0;return e===t&&(e=t.slice()),e.push(n),function(){r&&t!==J&&(r=!1,e===t&&(e=t.slice()),e.splice(e.indexOf(n),1))}}}}function h(t){return function(){return t}}function y(){}function b(t,e){var n={run:function(r){try{var o=t(e.getRealm(),r);(o!==n.props||n.error)&&(n.shouldComponentUpdate=!0,n.props=o,n.error=null)}catch(t){n.shouldComponentUpdate=!0,n.error=t}},cleanup:t.cleanup};return n}function m(t){var e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.getDisplayName,s=void 0===i?function(t){return"ConnectAdvanced("+t+")"}:i,u=o.methodName,p=void 0===u?"connectAdvanced":u,c=o.renderCountProp,a=void 0===c?void 0:c,f=o.shouldHandleStateChanges,d=void 0===f||f,l=o.storeKey,h=void 0===l?"realmStore":l,m=o.withRef,v=void 0!==m&&m,w=F(o,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),O=h+"Subscription",P=pt++,g=(e={},e[h]=ut,e[O]=st,e),E=(r={},r[O]=st,r);return function(e){z("function"==typeof e,"You must pass a component to the function returned by connect. Instead received "+JSON.stringify(e));var r=e.displayName||e.name||"Component",o=s(r),i=q({},w,{getDisplayName:s,methodName:p,renderCountProp:a,shouldHandleStateChanges:d,storeKey:h,withRef:v,displayName:o,wrappedComponentName:r,WrappedComponent:e}),u=function(r){function s(t,e){W(this,s);var n=Q(this,r.call(this,t,e));return n.version=P,n.state={},n.renderCount=0,n.store=t[h]||e[h],n.propsMode=!!t[h],n.setWrappedInstance=n.setWrappedInstance.bind(n),z(n.store,'Could not find "'+h+'" in either the context or props of "'+o+'". Either wrap the root component in a <Provider>, or explicitly pass "'+h+'" as a prop to "'+o+'".'),n.initSelector(),n.initSubscription(),n}return D(s,r),s.prototype.getChildContext=function(){var t,e=this.propsMode?null:this.subscription;return t={},t[O]=e||this.context[O],t},s.prototype.componentDidMount=function(){d&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},s.prototype.componentWillReceiveProps=function(t){this.selector.run(t)},s.prototype.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},s.prototype.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=y,this.store=null,this.selector.cleanup(),this.selector.run=y,this.selector.cleanup=y,this.selector.shouldComponentUpdate=!1},s.prototype.getWrappedInstance=function(){return z(v,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+p+"() call."),this.wrappedInstance},s.prototype.setWrappedInstance=function(t){this.wrappedInstance=t},s.prototype.initSelector=function(){var e=t(this.store.dispatch,i);(this.selector=b(e,this.store)).run(this.props)},s.prototype.initSubscription=function(){if(d){var t=(this.propsMode?this.props:this.context)[O];this.subscription=new X(this.store,t,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},s.prototype.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(ct)):this.notifyNestedSubs()},s.prototype.notifyNestedSubsOnComponentDidUpdate=function(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},s.prototype.isSubscribed=function(){return!!this.subscription&&this.subscription.isSubscribed()},s.prototype.addExtraProps=function(t){if(!(v||a||this.propsMode&&this.subscription))return t;var e=q({},t);return v&&(e.ref=this.setWrappedInstance),a&&(e[a]=++this.renderCount),this.propsMode&&this.subscription&&(e[O]=this.subscription),e},s.prototype.render=function(){var t=this.selector;if(t.shouldComponentUpdate=!1,t.error)throw t.error;return n.createElement(e,this.addExtraProps(t.props))},s}(n.Component);return u.WrappedComponent=e,u.displayName=o,u.childContextTypes=E,u.contextTypes=g,u.propTypes=g,Y(u,e)}}function v(t){return function(e,n){function r(){return o}var o=t(e,n);return r.dependsOnOwnProps=!1,r}}function w(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?!!t.dependsOnOwnProps:1!==t.length}function O(t,e){return function(e,n){var r=function(t,e){return r.dependsOnOwnProps?r.mapToProps(t,e):r.mapToProps(t)};return r.dependsOnOwnProps=!0,r.mapToProps=function(e,n){r.mapToProps=t,r.dependsOnOwnProps=w(t);var o=r(e,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=w(o),o=r(e,n)),o},r}}function P(t,e,n){return q({},n,t,e)}function g(t){return function(e,n){var r=n.pure,o=n.areMergedPropsEqual,i=!1,s=void 0;return function(e,n,u){var p=t(e,n,u);return i?r&&o(p,s)||(s=p):(i=!0,s=p),s}}}function E(t,e,n,r,o){return function(i,s){return r(e(t(i,s),s),n(o,s),s)}}function S(t,e,n,r,o,i){function s(t,e){for(var n=Object.keys(e),r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var s;if(r){if(i>=n.length)break;s=n[i++]}else{if((i=n.next()).done)break;s=i.value}if(e[s].length>0)return S=!0,void(m&&o({type:k.UNSAFE_WRITE}))}}function u(t){t&&t.forEach(function(t){return t.removeListener(s)})}function p(t){t&&t.forEach(function(t){return t.addListener(s)}),u(w),w=t,S=!0}function c(i,s){return p(t(i,s)),O=s,P=e(w,O),g=n(o,O),E=r(P,g,O),v=!0,E}function a(){return P=e(w,O),n.dependsOnOwnProps&&(g=n(o,O)),E=r(P,g,O),S=!1,E}function f(){return e.dependsOnOwnProps&&(P=e(w,O)),n.dependsOnOwnProps&&(g=n(o,O)),E=r(P,g,O)}function d(){var t=e(w,O),n=!b(t,P);return P=t,n&&(E=r(P,g,O)),S=!1,E}function l(e,n){var r=!y(n,O);return r&&t.dependsOnOwnProps&&p(t(e,O)),O=n,r&&S?a():r?f():S?d():E}function h(t,e){return v?l(t,e):c(t,e)}var y=i.areOwnPropsEqual,b=i.areQueryPropsEqual,m=i.watchUnsafeWrites,v=!1,w=void 0,O=void 0,P=void 0,g=void 0,E=void 0,S=!1;return h.cleanup=function(){p(null)},h}function T(t,e){var n=e.initMapPropsToQueries,r=e.initMapQueriesToProps,o=e.initMapDispatchToProps,i=e.initMergeProps,s=F(e,["initMapPropsToQueries","initMapQueriesToProps","initMapDispatchToProps","initMergeProps"]),u=n(t,s),p=r(t,s),c=o(t,s),a=i(t,s);return(s.pure?S:E)(u,p,c,a,t,s)}function C(t,e,n){for(var r=e.length-1;r>=0;r--){var o=e[r](t);if(o)return o}return function(e,r){throw Error("Invalid value of type "+typeof t+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}e=e&&"default"in e?e.default:e;var N="[object Object]",R=Function.prototype,j=Object.prototype,x=R.toString,U=j.hasOwnProperty,I=x.call(Object),_=j.toString,A=function(t,e){return function(n){return t(e(n))}}(Object.getPrototypeOf,Object),M=function(t){if(!o(t)||_.call(t)!=N||r(t))return!1;var e=A(t);if(null===e)return!0;var n=U.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&x.call(n)==I},W=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},q=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},F=function(t,e){var n={};for(var r in t)0>e.indexOf(r)&&Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},Q=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},k={INIT:"@@realm-react-redux/INIT",PROBE_UNKNOWN_ACTION:"@@realm-react-redux/PROBE_UNKNOWN_ACTION",UNSAFE_WRITE:"@@realm-react-redux/UNSAFE_WRITE"},L=function(){function t(e){W(this,t),this._error=e}return t.prototype.throw=function(){throw Error(this._error)},t.prototype.open=function(){this.throw()},t.prototype.openAsync=function(){this.throw()},t.prototype.schemaVersion=function(){this.throw()},t.prototype.addListener=function(){this.throw()},t.prototype.close=function(){this.throw()},t.prototype.create=function(){this.throw()},t.prototype.delete=function(){this.throw()},t.prototype.deleteAll=function(){this.throw()},t.prototype.objectForPRimaryKey=function(){this.throw()},t.prototype.objects=function(){this.throw()},t.prototype.removeAllListeners=function(){this.throw()},t.prototype.removeListener=function(){this.throw()},t.prototype.write=function(){this.throw()},t}(),H=Object.prototype.hasOwnProperty,K={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,mixins:!0,propTypes:!0,type:!0},B={name:!0,length:!0,prototype:!0,caller:!0,arguments:!0,arity:!0},V="function"==typeof Object.getOwnPropertySymbols,Y=function(t,e,n){if("string"!=typeof e){var r=Object.getOwnPropertyNames(e);V&&(r=r.concat(Object.getOwnPropertySymbols(e)));for(var o=0;r.length>o;++o)if(!(K[r[o]]||B[r[o]]||n&&n[r[o]]))try{t[r[o]]=e[r[o]]}catch(t){}}return t},z=function(t,e,n,r,o,i,s,u){if(!t){var p;if(void 0===e)p=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,s,u],a=0;(p=Error(e.replace(/%s/g,function(){return c[a++]}))).name="Invariant Violation"}throw p.framesToPop=1,p}},J=null,G={notify:function(){}},X=function(){function t(e,n,r){W(this,t),this.store=e,this.parentSub=n,this.onStateChange=r,this.unsubscribe=null,this.listeners=G}return t.prototype.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},t.prototype.notifyNestedSubs=function(){this.listeners.notify()},t.prototype.isSubscribed=function(){return!!this.unsubscribe},t.prototype.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=l())},t.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=G)},t}(),Z="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$=function(){};$.thatReturns=h,$.thatReturnsFalse=h(!1),$.thatReturnsTrue=h(!0),$.thatReturnsNull=h(null),$.thatReturnsThis=function(){return this},$.thatReturnsArgument=function(t){return t};var tt=$,et=function(t){},nt=function(t,e,n,r,o,i,s,u){if(et(e),!t){var p;if(void 0===e)p=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,s,u],a=0;(p=Error(e.replace(/%s/g,function(){return c[a++]}))).name="Invariant Violation"}throw p.framesToPop=1,p}},rt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ot=function(){function t(t,e,n,r,o,i){i!==rt&&nt(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e};return n.checkPropTypes=tt,n.PropTypes=n,n},it=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t){t.exports=ot()}),st=it.shape({trySubscribe:it.func.isRequired,tryUnsubscribe:it.func.isRequired,notifyNestedSubs:it.func.isRequired,isSubscribed:it.func.isRequired}),ut=it.shape({subscribe:it.func.isRequired,dispatch:it.func.isRequired,getRealm:it.func.isRequired}),pt=0,ct={},at="object"==typeof Z&&Z&&Z.Object===Object&&Z,ft="object"==typeof self&&self&&self.Object===Object&&self,dt=(at||ft||Function("return this")(),function(t,e){}(Object.getPrototypeOf,Object),Function.prototype.toString.call(Object),[function(t){return"function"==typeof t?O(t,"mapDispatchToProps"):void 0},function(t){return t?void 0:v(function(t){return{dispatch:t}})},function(t){return t&&"object"==typeof t?v(function(e){return c(t,e)}):void 0}]),lt=[function(t){return"function"==typeof t?O(t,"mapPropsToQueries"):void 0},function(t){return t?void 0:v(function(){return[]})}],ht=[function(t){return"function"==typeof t?O(t,"mapQueriesToProps"):void 0},function(t){return t?void 0:v(function(){return{}})}],yt=[function(t){return"function"==typeof t?g(t):void 0},function(t){return t?void 0:function(){return P}}],bt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.connectHOC,n=void 0===e?m:e,r=t.mapPropsToQueriesFactories,o=void 0===r?lt:r,i=t.mapQueriesToPropsFactories,s=void 0===i?ht:i,u=t.mapDispatchToPropsFactories,p=void 0===u?dt:u,c=t.mergePropsFactories,a=void 0===c?yt:c,f=t.selectorFactory,l=void 0===f?T:f;return function(t,e,r,i){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=u.pure,f=void 0===c||c,h=u.areOwnPropsEqual,y=void 0===h?d:h,b=u.areQueryPropsEqual,m=void 0===b?d:b,v=u.areMergedPropsEqual,w=void 0===v?d:v,O=F(u,["pure","areOwnPropsEqual","areQueryPropsEqual","areMergedPropsEqual"]),P=C(t,o,"mapPropsToQueries"),g=C(e,s,"mapQueriesToProps"),E=C(r,p,"mapDispatchToProps"),S=C(i,a,"mergeProps");return n(l,q({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:!!t&&!!e,initMapPropsToQueries:P,initMapQueriesToProps:g,initMapDispatchToProps:E,initMergeProps:S,pure:f,areOwnPropsEqual:y,areQueryPropsEqual:m,areMergedPropsEqual:w},O))}}(),mt=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"realmStore",r=arguments[1]||e+"Subscription",o=function(t){function o(n,r){W(this,o);var i=Q(this,t.call(this,n,r));return i[e]=n[e],i}return D(o,t),o.prototype.getChildContext=function(){var t;return t={},t[e]=this[e],t[r]=null,t},o.prototype.render=function(){return n.Children.only(this.props.children)},o}(n.Component);return o.propTypes={realmStore:ut.isRequired,children:it.element.isRequired},o.childContextTypes=(t={},t[e]=ut.isRequired,t[r]=st,t),o.displayName="RealmProvider",o}();t.createRealmStore=s,t.combineWriters=function(t){var e=[];return t.forEach(function(t){"function"==typeof t&&e.push(t)}),u(e),function(t,n){for(var r=e,o=Array.isArray(r),i=0,r=o?r:r[Symbol.iterator]();;){var s;if(o){if(i>=r.length)break;s=r[i++]}else{if((i=r.next()).done)break;s=i.value}s(t,n)}}},t.bindActionCreators=c,t.applyMiddleware=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return function(t){return function(n,r,o){var i=t(n,r,o),s=i.dispatch,u=[],p={getRealm:function(){return i.realm},dispatch:function(t){return s(t)}};return u=e.map(function(t){return t(p)}),s=a.apply(void 0,u)(i.dispatch),q({},i,{dispatch:s})}}},t.compose=a,t.RealmProvider=mt,t.realmConnect=bt,Object.defineProperty(t,"__esModule",{value:!0})});
